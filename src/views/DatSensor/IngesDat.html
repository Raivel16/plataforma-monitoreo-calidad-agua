<div class="contenedor-ingesta">
  <h2>ðŸ“Š Ingesta de Datos de Sensores</h2>

  <div class="tabla-container">
    <table id="tablaSensores">
      <thead>
        <tr>
          <th>ID</th>
          <th>ID Sensor</th>
          <th>ID parÃ¡metro</th>
          <th>Tiempo de Registro</th>
          <th>Tiempo de Envio</th>
          <th>Valor Original</th>
          <th>Valor Procesado</th>
          <th>Valor Normalizado</th>
        </tr>
      </thead>
      <tbody>
        <tr><td colspan="7" class="cargando">Cargando datos...</td></tr>
      </tbody>
    </table>
  </div>
</div>

<script>
  // âœ… URL del backend (te la da el encargado de la BD)
  const API_URL = "http://localhost:3000/api/data";

  async function cargarDatosSensores() {
    const tbody = document.querySelector("#tablaSensores tbody");
    tbody.innerHTML = `<tr><td colspan="7" class="cargando">Cargando datos...</td></tr>`;

    try {
      const res = await fetch(API_URL);
      const data = await res.json();

      if (!data.length) {
        tbody.innerHTML = `<tr><td colspan="7">No hay datos disponibles</td></tr>`;
        return;
      }

      tbody.innerHTML = data.map(item => `
        <tr>
          <td>${item.DatoId ?? "-"}</td>
          <td>${item.SensorID ?? "-"}</td>
          <td>${item.ParametroID ?? "-"}</td>
          <td>${item.TimestampRegistro ?? "-"}</td>
          <td>${item.TimestampEnvio ?? "-"}</td>
          <td>${item.Valor_original ?? "-"}</td>
          <td>${item.Valor_procesado ?? "-"}</td>
          <td>${item.Valor_normalizado ?? "-"}</td>
        </tr>
      `).join("");
    } catch (err) {
      console.error(err);
      tbody.innerHTML = `<tr><td colspan="7" class="error">Error al cargar los datos.</td></tr>`;
    }
  }

  cargarDatosSensores();
</script>
